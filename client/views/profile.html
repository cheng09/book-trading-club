<div layout="column" class="bodycontent">
  <div layout="column" layout-margin>
    <md-card style="min-width: 500px;">
        <md-toolbar class="md-hue-1" Layout-align="end start" layout-padding>
          <md-cart-title layout="column">
            <md-card-title-text>
              <span class="md-headline">Your Account Statistics</span>
            </md-card-title-text>
          </md-card-title>
        </md-toolbar>
        <md-card-content layout="column">
          <h3>Your Statistics</h3>
          <table id="user-stats">
            <tbody>
              <tr>
                <td class="stat">{{ profile.collection.length }}</td>
                <td>books in your collection</td>
                <td><a href="/search">Add books you own</a></td>
              </tr>
              <tr>
                <td class="stat">{{ profile.wishlist.length }}</td>
                <td>books on your wishlist</td>
                <td><a href="/books">Find more books you want</a></td>
              </tr>
              <tr>
                <td class="stat">{{ profile.pending.length }}</td>
                <td>pending trades for you to approve</td>
                <td><a href="/profile#pending">See your pending trade list</a></td>
              </tr>
              <tr>
                <td class="stat">{{ profile.approved.length }}</td>
                <td>outstanding trades to be completed</td>
                <td><a href="/approved">See your in-progress trades</a></td>
              </tr>
            </tbody>
            </table> 
          
            <h4>Completed trades</h4> 
            <p>You have successfully completed {{ profile.totaltrades }} â€” you have given away {{ profile.tradesgiven }} books, and received {{ profile.tradesreceived }} books.</p>
          </div>
        </md-card-content>
      </md-card>
  
    <div layout="row">
      <md-card style="min-width: 250px;">
        <md-toolbar class="md-hue-3" Layout-align="end start"layout-padding>
          <md-cart-title layout="column">
            <md-card-title-text>
              <span class="md-headline">Your Details</span>
            </md-card-title-text>
          </md-card-title>
        </md-toolbar>
        <md-card-content layout="column">
          <p>Email: {{ profile.user.email }}</p>
          <p ng-show="profile.user.firstname">Name: {{ profile.user.firstname }} {{ profile.user.lastname }}</p>
          <p ng-show="profile.user.city">Location: {{ profile.user.city}}, {{profile.user.state }}</p>
          <p ng-hide="profile.user.city">You are more likely to be considered for trades if you add your location <a href="/settings">to your profile</a>.</p>
        </md-card-content>
        <md-card-actions layout="column" layout-align="end center">
          <md-button href="settings"><md-icon>settings</md-icon> Update Settings</md-button>
        </md-card-actions>
      </md-card>
    
      <md-card style="min-width: 250px;">
        <md-toolbar class="md-accent" Layout-align="end start" layout-padding>
          <md-cart-title>
            <md-card-title-text>
              <span class="md-headline">Note on Privacy</span>
            </md-card-title-text>
          </md-card-title>
        </md-toolbar>
        <md-card-content>
          <p>Your details kept private by default. Until you wishlist a book, which kicks off the trade process, no one else will see any of your personal information. The only information made public will be the titles/covers of any books you add to your collection.</p>
          <p>After you wishlist a book, the users who own this title will be notified that a user in a given city is looking that book. They will also see a summary of your trading activity (completed trades), but not your contact info/name/username.</p>
          <p>Once a user accepts the trade, you will have access to each other's contact information, including email. Arrangements to complete the trade must be made via email, outside of this site.</p>
        </md-card-content>
      </md-card>
    </div>
  </div>
  <div layout="column" layout-margin class="grid">
    <a id="collection"><h2>Your Book Collection</h2></a>
    <p ng-show="profile.collection.length >= 5">These are the books you own right now. You can always <a href="/search">add more</a>. Anything you trade will be added/removed automatically.</p>
    <p ng-hide="profile.collection.length > 5">Not much in your collection yet? You should <a href="/search">add something!</a></p>
    <div class="grid" ng-show="profile.collection">
      <md-grid-list md-cols="2"  md-cols-sm="3" md-cols-md="4" md-cols-lg="6" md-cols-xl="7" md-gutter="1em" md-row-height="270px" flex>   
        <md-grid-tile ng-repeat="book in profile.collection" md-colspan="1" md-rowspan="1" flex flex-md="20" flex-lg="17" flex="14">
          <div class="cover" md-whiteframe layout="column" layout-align="center center">
            <h2 ng-hide="book.thumbnail">{{ book.title }}</h2>
            <img src="{{ book.thumbnail }}" ng-show="book.thumbnail" alt="book.title">
            <md-button class="removeItem" layout="row" layout-align="center center" ng-click="profile.removeFromCollection(book)">
              <md-icon>delete_forever</md-icon>
              <span>Remove</span>
            </md-button>
          </div>
        </md-grid-tile>
      </md-grid-list>
    </div>
  </div>
  <div layout="column" layout-margin class="grid">
    <a id="wishlist"><h2>Your Wishlist</h2></a>
    <p>These are the books you are hoping to add to your collection. Users who own these titles will be notified and may choose to fulfill your wish (in other words, they might give you the book).</p>
    <div class="grid" ng-show="profile.wishlist">
      <md-grid-list md-cols="2"  md-cols-sm="3" md-cols-md="4" md-cols-lg="6" md-cols-xl="7" md-gutter="1em" md-row-height="270px" flex>   
        <md-grid-tile ng-repeat="book in profile.wishlist" md-colspan="1" md-rowspan="1" flex flex-md="20" flex-lg="17" flex="14">
          <div class="cover" md-whiteframe layout="column" layout-align="center center">
            <h2 ng-hide="book.thumbnail">{{ book.title }}</h2>
            <img src="{{ book.thumbnail }}" ng-show="book.thumbnail" alt="book.title">
            <md-button class="removeItem" layout="row" layout-align="center center" ng-click="profile.removeFromWishlist(book)">
              <md-icon>delete_forever</md-icon>
              <span>Remove</span>
            </md-button>
          </div>
        </md-grid-tile>
      </md-grid-list>
    </div>
  </div>
  <div layout="column" layout-margin class="grid">
    <a id="pending"><h2>Your Pending Trades</h2></a>
    <p>Users have requested the following books from your collection. If you decide you want to fulfill a request, click "Approve this trade". The book will be hidden from your collection, so that you no longer receive trades requests for it, but it is up to you to contact the recipient and arrange the trade. You will be provided an email address once you approve the trade.</p>
    <md-card style="min-width: 250px;">
      <md-toolbar class="md-hue-1" Layout-align="end start" layout-padding>
        <md-cart-title layout="column">
          <md-card-title-text>
            <span class="md-headline">Your Pending Trades</span>
          </md-card-title-text>
        </md-card-title>
      </md-toolbar>
      <md-card-content layout="column">
        <table id="pending-trades">
          <thead>
            <tr>
              <td>A user in...</td>
              <td>has requested...</td>
              <td></td>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="trade in profile.pending">
              <td><span ng-show="trade.user.city">{{ trade.user.city }}, {{ trade.user.state }}</span><span ng-hide="trade.user.city">An undisclosed location</span></td>
              <td>{{ trade.book.title }}</td>
              <td><md-button>Approve this trade</md-button></td>
            </tr>
          </tbody>
        </table>
      </md-card-content>
    </md-card>
  </div>
</div>
<script>
  $('div').on('click', '.removeItem', function(e) {
    var target = $(e.target).parent().parent();
    $(target).css('display', 'none');
  })
</script>